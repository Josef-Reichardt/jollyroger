apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: deconz
  name: deconz
spec:
  replicas: 1
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app: deconz
  template:
    metadata:
      labels:
        app: deconz
    spec:
      containers:
      - name: deconz
        image: deconzcommunity/deconz
        env:
          - name: DECONZ_DEVICE
            value: "/dev/ttyACM0"
          - name: DECONZ_WEB_PORT
            value: 30080
          - name: DECONZ_WS_PORT
            value: 30443
        ports:
        - containerPort: 30080
        - containerPort: 30443
        securityContext:
          privileged: true
        volumeMounts:
        - mountPath: /dev/ttyACM0
          name: device
        - mountPath: /opt/deCONZ
          name: persistent-storage
        - mountPath: /etc/localtime
          name: localtime
        - mountPath: /etc/timezone
          name: timezone
      volumes:
      - name: device
        hostPath:
          path: /dev/ttyACM0
      - name: persistent-storage
        hostPath:
          path: /data/deconz
      - name: localtime
        hostPath:
          path: /etc/localtime
      - name: timezone
        hostPath:
          path: /etc/timezone
